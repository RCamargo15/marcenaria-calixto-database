CREATE TABLE IF NOT EXISTS MARCENARIA.CLIENTE(
COD_CLIENTE INT NOT NULL AUTO_INCREMENT,
NOME VARCHAR(150) NOT NULL,
RG VARCHAR(15) NOT NULL,
CPF VARCHAR(15) NOT NULL,
RUA VARCHAR(150) NOT NULL,
NUMERO INT NOT NULL,
COMPLEMENTO VARCHAR(100),
BAIRRO VARCHAR(150) NOT NULL,
CEP VARCHAR(9) NOT NULL,
CIDADE VARCHAR(100) NOT NULL,
ESTADO VARCHAR(50) NOT NULL,
UF VARCHAR(2) NOT NULL,
DDD VARCHAR(2) NOT NULL,
TELEFONE VARCHAR(10),
CELULAR VARCHAR(10),
EMAIL VARCHAR(60),
DATA_CADASTRO DATETIME NOT NULL,
OBS TEXT,
CONSTRAINT PK_COD_CLIENTE PRIMARY KEY(COD_CLIENTE)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.EMPRESA(
COD_EMPRESA INT NOT NULL AUTO_INCREMENT,
RAZAO_SOCIAL VARCHAR(200),
NOME_FANTASIA VARCHAR(200) NOT NULL,
CNPJ VARCHAR(20) NOT NULL,
ATIVIDADE_FIM VARCHAR(50) NOT NULL,
RUA VARCHAR(100) NOT NULL,
NUMERO INT NOT NULL,
COMPLEMENTO VARCHAR(100),
BAIRRO VARCHAR(150) NOT NULL,
CEP VARCHAR(9) NOT NULL,
CIDADE VARCHAR(100) NOT NULL,
ESTADO VARCHAR(50) NOT NULL,
UF VARCHAR(2) NOT NULL,
DDD VARCHAR(2) NOT NULL,
TELEFONE VARCHAR(10) NOT NULL,
SITE VARCHAR(100),
EMAIL VARCHAR(100),
OBS TEXT,
CONSTRAINT PK_COD_EMPRESA PRIMARY KEY(COD_EMPRESA)
); 

CREATE TABLE IF NOT EXISTS MARCENARIA.FORNECEDOR(
COD_FORNECEDOR INT NOT NULL AUTO_INCREMENT,
RAZAO_SOCIAL VARCHAR(200),
NOME_FANTASIA VARCHAR(200) NOT NULL,
CNPJ VARCHAR(20) NOT NULL,
ATIVIDADE_FIM VARCHAR(50) NOT NULL,
RUA VARCHAR(100) NOT NULL,
NUMERO INT NOT NULL,
COMPLEMENTO VARCHAR(100),
BAIRRO VARCHAR(150) NOT NULL,
CEP VARCHAR(9) NOT NULL,
CIDADE VARCHAR(100) NOT NULL,
ESTADO VARCHAR(50) NOT NULL,
UF VARCHAR(2) NOT NULL,
DDD VARCHAR(2) NOT NULL,
TELEFONE VARCHAR(10) NOT NULL,
SITE VARCHAR(100),
EMAIL VARCHAR(100),
OBS TEXT,
CONSTRAINT PK_COD_FORNECEDOR PRIMARY KEY(COD_FORNECEDOR)
); 

CREATE TABLE IF NOT EXISTS MARCENARIA.FUNCIONARIO(
REGISTRO_FUNC INT NOT NULL AUTO_INCREMENT,
NOME VARCHAR(150) NOT NULL,
RG VARCHAR(15) NOT NULL,
CPF VARCHAR(15) NOT NULL,
CTPS VARCHAR(15),
RUA VARCHAR(150) NOT NULL,
NUMERO INT NOT NULL,
COMPLEMENTO VARCHAR(100),
BAIRRO VARCHAR(150) NOT NULL,
CEP VARCHAR(9) NOT NULL,
CIDADE VARCHAR(100) NOT NULL,
ESTADO VARCHAR(50) NOT NULL,
UF VARCHAR(2) NOT NULL,
DDD VARCHAR(2) NOT NULL,
TELEFONE VARCHAR(10),
CELULAR VARCHAR(10),
DATA_NASC DATETIME NOT NULL,
DATA_ADMISSAO DATETIME NOT NULL,
TIPO_SANG VARCHAR(3) NOT NULL,
FUNCAO VARCHAR(50) NOT NULL,
SETOR VARCHAR(50),
SALARIO DECIMAL(10,2) NOT NULL,
OBS TEXT,
CONSTRAINT PK_FUNCIONARIO PRIMARY KEY(REGISTRO_FUNC)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.PRODUTO(
COD_PRODUTO INT NOT NULL AUTO_INCREMENT,
DESC_PRODUTO VARCHAR(250) NOT NULL,
CONSTRAINT PK_PRODUTO PRIMARY KEY(COD_PRODUTO)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.ESTOQUE(
ID INT NOT NULL AUTO_INCREMENT,
COD_PRODUTO INT NOT NULL UNIQUE,
ESTOQUE_ATUAL INT NOT NULL,
ESTOQUE_MINIMO INT NOT NULL,
CONSTRAINT PK_ESTOQUE PRIMARY KEY(ID),
CONSTRAINT FK_ESTOQUE_2_PRODUTO FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.PRODUTO(COD_PRODUTO)
);


CREATE TABLE IF NOT EXISTS MARCENARIA.NOTA_COMPRA_MATERIAL(
COD_NOTA INT NOT NULL AUTO_INCREMENT,
COD_FORNECEDOR INT NOT NULL,
NUMERO_NF VARCHAR(15) NOT NULL,
COD_PRODUTO INT NOT NULL,
QUANTIDADE INT NOT NULL,
VALOR_UNIT DECIMAL(10,2) NOT NULL,
VALOR_TOTAL DECIMAL(10,2) NOT NULL,
VALOR_TOTAL_NOTA DECIMAL(10,2) NOT NULL,
CHAVE_NF VARCHAR(45) NOT NULL,
DATA_EMISSAO DATETIME NOT NULL,
DATA_ENTRADA DATETIME NOT NULL,
OBS TEXT,
CONSTRAINT PK_NOTA_COMPRA PRIMARY KEY(COD_NOTA, NUMERO_NF),
CONSTRAINT FK_NOTA_COMPRA_2_FORNECEDOR FOREIGN KEY(COD_FORNECEDOR)
	REFERENCES MARCENARIA.FORNECEDOR(COD_FORNECEDOR),
CONSTRAINT FK_NOTA_COMPRA_2_PRODUTO FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.PRODUTO(COD_PRODUTO)
);

ALTER TABLE nota_compra_material ADD INDEX(valor_total);
ALTER TABLE nota_compra_material ADD INDEX(valor_total_nota);
ALTER TABLE nota_compra_material ADD INDEX(NUMERO_NF);

CREATE TABLE IF NOT EXISTS MARCENARIA.ENTRADA_PRODUTO(
COD_ENTRADA INT NOT NULL AUTO_INCREMENT,
NUMERO_NF VARCHAR(15) NOT NULL,
COD_PRODUTO INT NOT NULL,
DATA_ENTRADA DATETIME NOT NULL,
QUANTIDADE INT NOT NULL,
VALOR_UNIT DECIMAL(10,2) NOT NULL,
VALOR_TOTAL DECIMAL(10,2) NOT NULL,
VALOR_TOTAL_NOTA DECIMAL(10,2) NOT NULL,
CONSTRAINT PK_COD_ENTRADA PRIMARY KEY(COD_ENTRADA),

CONSTRAINT FK_PRODUTO_2_PRODUTO FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.PRODUTO(COD_PRODUTO)
);


ALTER TABLE ENTRADA_PRODUTO ADD FOREIGN KEY(valor_TOTAL) REFERENCES nota_compra_material(valor_TOTAL);
ALTER TABLE ENTRADA_PRODUTO ADD FOREIGN KEY(valor_TOTAL_NOTA) REFERENCES nota_compra_material(valor_TOTAL_NOTA);
ALTER TABLE ENTRADA_PRODUTO ADD FOREIGN KEY(NUMERO_NF) REFERENCES nota_compra_material(NUMERO_NF);

CREATE TABLE IF NOT EXISTS MARCENARIA.SAIDA_PRODUTO(
COD_SAIDA INT NOT NULL AUTO_INCREMENT,
ID_ESTOQUE INT NOT NULL,
COD_PRODUTO INT NOT NULL,
DATA_SAIDA DATETIME NOT NULL,
QUANTIDADE INT NOT NULL,
RESP_SAIDA INT NOT NULL,
CONSTRAINT PK_SAIDA_PRODUTO PRIMARY KEY(COD_SAIDA),
CONSTRAINT FK_SAIDA_PRODUTO_2_ID_ESTOQUE FOREIGN KEY(ID_ESTOQUE)
	REFERENCES MARCENARIA.ESTOQUE(ID),
CONSTRAINT FK_SAIDA_PRODUTO_2_ESTOQUE FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.ESTOQUE(COD_PRODUTO),
CONSTRAINT FK_SAIDA_PRODUTO_2_FUNCIONARIO FOREIGN KEY(RESP_SAIDA)
	REFERENCES MARCENARIA.FUNCIONARIO(REGISTRO_FUNC)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.ORDEM_SERVICO_CLIENTE(
ID INT NOT NULL AUTO_INCREMENT,
NUM_PEDIDO INT NOT NULL,
COD_CLIENTE INT NOT NULL,
DESC_SERVICO VARCHAR(255) NOT NULL,
DATA_ORDEM DATETIME NOT NULL,
DATA_INICIO DATETIME,
PRAZO_ENTREGA DATETIME,
DATA_ENTREGA DATETIME,
STATUS_SERVICO VARCHAR(20) NOT NULL,
VALOR_TOTAL DECIMAL(10,2) NOT NULL,
FUNC_RESPONSAVEL INT NOT NULL,
OBS TEXT,
CONSTRAINT PK_ORDEM_SERVICO PRIMARY KEY(ID),
CONSTRAINT FK_ORDEM_SERVICO_2_CLIENT FOREIGN KEY(COD_CLIENTE)
	REFERENCES MARCENARIA.CLIENTE(COD_CLIENTE),
CONSTRAINT FK_ORDEM_SERVICO_2_FUNCIONARIO FOREIGN KEY(FUNC_RESPONSAVEL)
	REFERENCES MARCENARIA.FUNCIONARIO(REGISTRO_FUNC)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.ORDEM_SERVICO_EMPRESA(
ID INT NOT NULL AUTO_INCREMENT,
NUM_PEDIDO INT NOT NULL,
COD_EMPRESA INT NOT NULL,
NOME_RESPONSAVEL VARCHAR(150) NOT NULL,
DESC_SERVICO VARCHAR(255) NOT NULL,
DATA_ORDEM DATETIME NOT NULL,
DATA_INICIO DATETIME,
PRAZO_ENTREGA DATETIME,
DATA_ENTREGA DATETIME,
STATUS_SERVICO VARCHAR(30),
VALOR_TOTAL DECIMAL(10,2) NOT NULL,
REGISTRO_FUNC INT NOT NULL,
OBS TEXT,
CONSTRAINT PK_ORDEM_SERVICO PRIMARY KEY(ID),
CONSTRAINT FK_ORDEM_SERVICO_2_EMPRESA FOREIGN KEY(COD_EMPRESA)
	REFERENCES MARCENARIA.EMPRESA(COD_EMPRESA),
CONSTRAINT FK_ORDEM_SERVICO_2_FUNCIONARIO_E FOREIGN KEY(REGISTRO_FUNC)
	REFERENCES MARCENARIA.FUNCIONARIO(REGISTRO_FUNC)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.ORCAMENTO_CLIENTE(
ID INT NOT NULL AUTO_INCREMENT,
NUM_ORCAMENTO INT NOT NULL,
COD_CLIENTE INT NOT NULL,
TELEFONE VARCHAR(15),
CELULAR VARCHAR(15),
EMAIL VARCHAR(100),
DESC_SERVICO TEXT NOT NULL,
DATA_ORCAMENTO DATETIME NOT NULL,
COD_PRODUTO INT NOT NULL,
QUANTIDADE INT NOT NULL,
VALOR DECIMAL(10,2),
VALOR_TOTAL DECIMAL(10,2),
VALOR_QUAD DECIMAL(10,2),
VALOR_OBRA DECIMAL(10,2),
OBS TEXT,
CONSTRAINT PK_ORCAMENTO_CLIENTE PRIMARY KEY(ID),
CONSTRAINT FK_COD_CLIENTE_2_CLIENTE FOREIGN KEY(COD_CLIENTE)
	REFERENCES MARCENARIA.CLIENTE(COD_CLIENTE),
CONSTRAINT FK_PRODUTO_2_PROD FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.PRODUTO(COD_PRODUTO)
);

CREATE TABLE IF NOT EXISTS MARCENARIA.ORCAMENTO_EMPRESA(
ID INT NOT NULL AUTO_INCREMENT,
NUM_ORCAMENTO INT NOT NULL,
COD_EMPRESA INT NOT NULL,
NOME_RESPONSAVEL VARCHAR(150) NOT NULL,
TELEFONE VARCHAR(15),
CELULAR VARCHAR(15),
EMAIL VARCHAR(100),
DESC_SERVICO TEXT NOT NULL,
DATA_ORCAMENTO DATETIME NOT NULL,
COD_PRODUTO INT NOT NULL,
QUANTIDADE INT NOT NULL,
VALOR DECIMAL(10,2),
VALOR_TOTAL DECIMAL(10,2),
VALOR_QUAD DECIMAL(10,2),
VALOR_OBRA DECIMAL(10,2),
OBS TEXT,
CONSTRAINT PK_ORCAMENTO_EMPRESA PRIMARY KEY(ID),
CONSTRAINT FK_COD_EMPRESA_2_EMPRESA FOREIGN KEY(COD_EMPRESA)
	REFERENCES MARCENARIA.EMPRESA(COD_EMPRESA),
CONSTRAINT FK_PRODUTO_2_PROD2 FOREIGN KEY(COD_PRODUTO)
	REFERENCES MARCENARIA.PRODUTO(COD_PRODUTO)
);




PARA DROPAR TABELAS

DROP TABLE IF EXISTS MARCENARIA.SAIDA_PRODUTO;
DROP TABLE IF EXISTS MARCENARIA.ENTRADA_PRODUTO;
DROP TABLE IF EXISTS MARCENARIA.ESTOQUE;
DROP TABLE IF EXISTS MARCENARIA.PRODUTO;
DROP TABLE IF EXISTS MARCENARIA.ORDEM_SERVICO;
DROP TABLE IF EXISTS MARCENARIA.NOTA_COMPRA_PECA;
DROP TABLE IF EXISTS MARCENARIA.FUNCIONARIO;
